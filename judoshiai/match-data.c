/* -*- mode: C; c-basic-offset: 4;  -*- */

/*
 * Copyright (C) 2006-2016 by Hannu Jokinen
 * Full copyright text is included in the software package.
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <gtk/gtk.h>

#include <cairo.h>
#include <cairo-pdf.h>

#include <assert.h>

#include "judoshiai.h"

// pool matches
const guint pools[11][32][2] = {
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 0 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 1 */
    {{1, 2}, {1, 2}, {1, 2}, {0,0}}, /* 2 */
    {{1, 2}, {1, 3}, {2, 3}, {0,0}}, /* 3 */
    {{1, 2}, {3, 4}, {1, 3}, {2, 4}, {1, 4}, {2, 3}, {0,0}}, /* 4 */
    {{4, 5}, {1, 2}, {3, 4}, {1, 5}, {2, 3}, {1, 4}, {3, 5}, {2, 4}, {1, 3}, {2, 5}, {0,0}}, /* 5 */
    {{1,2},{3,5},{2,4},{1,6},{4,5},{2,3},{4,6},{2,5},{3,4},{1,5},{3,6},{1,4},{5,6},{1,3},{2,6}, {0,0}}, /* 6 */
    {{1,2},{3,5},{2,4},{1,6},{3,7},{4,5},{2,3},{4,6},{1,7},{2,5},{6,7},{3,4},{1,5},{3,6},{2,7},
     {1,4},{5,6},{4,7},{2,6},{1,3},{5,7}, {0,0}} /* 7 */
};

// double pool matches
const guint poolsd[13][32][2] = {
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 0 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 1 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 2 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 3 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 4 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 5 */
    {{1, 2}, {4, 5}, {1, 3}, {4, 6}, {2, 3}, {5, 6}, {0,0}}, /* 6 */
    {{1, 2}, {3, 4}, {5, 6}, {1, 3}, {2, 4}, {5, 7}, {1, 4}, {2, 3}, {6, 7}, {0,0}}, /* 7 */

    {{1, 2}, {5, 6}, {3, 4}, {7, 8}, {1, 3}, {5, 7}, {2, 4}, {6, 8}, {1, 4}, {5, 8},
     {2, 3}, {6, 7}, {0,0}}, /* 8 */

    {{4, 5}, {1, 2}, {6, 7}, {3, 4}, {1, 5}, {8, 9}, {2, 3}, {6, 8}, {1, 4}, {3, 5},
     {7, 9}, {2, 4}, {1, 3}, {6, 9}, {2, 5}, {7, 8}, {0,0}}, /* 9 */

    {{4, 5}, {9,10}, {1, 2}, {6, 7}, {3, 4}, {8, 9}, {1, 5}, {6,10}, {2, 3}, {7, 8},
     {1, 4}, {6, 9}, {3, 5}, {8,10}, {2, 4}, {7, 9}, {1, 3}, {6, 8}, {2, 5}, {7,10}, {0,0}}, /* 10 */

    {{1,2}, {10, 11}, {3,5}, {7, 8}, {2,4}, {9, 10}, {1,6}, {7, 11}, {4,5}, {8, 9}, {2,3},
     {7, 10}, {4,6}, {2,5}, {9, 11}, {3,4}, {1,5}, {8, 10}, {3,6}, {1,4}, {7, 9},
     {5,6}, {1,3}, {8, 11}, {2,6}, {0,0}}, /* 11 */

    {{1,2},{7,8},{3,5},{9,11},{2,4},{8,10},{1,6},{7,12},{4,5},{10,11},{2,3},{8,9},
     {4,6},{10,12},{2,5},{8,11},{3,4},{9,10},{1,5},{7,11},{3,6},{9,12},{1,4},{7,10},{5,6},
     {11,12},{1,3},{7,9},{2,6},{8,12}, {0,0}} /* 12 */
};


// quadruple pool matches
const guint poolsq[21][48][2] = {
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 0 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 1 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 2 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 3 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 4 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 5 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 6 */
    {{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0},{0,0}}, /* 7 */
    {{1,2},{3,4},{5,6},{7,8},{0,0}}, /* 8 */
    {{1,2},{4,5},{1,3},{6,7},{2,3},{8,9},{0,0}}, /* 9 */
    {{1,2},{4,5},{1,3},{4,6},{7,8},{2,3},{5,6},{9,10},{0,0}}, /* 10 */
    {{1,2},{4,5},{7,8},{1,3},{4,6},{7,9},{10,11},{2,3},{5,6},{8,9},{0,0}}, /* 11 */
    {{1,2},{4,5},{7,8},{10,11},{1,3},{4,6},{7,9},{10,12},{2,3},{5,6},{8,9},{11,12},{0,0}}, /* 12 */
    {{1,2},{5,6},{8,9},{3,4},{11,12},{5,7},{1,3},{8,10},{11,13},{2,4},{6,7},{9,10},{1,4},{12,13},{2,3},{0,0}}, /* 13 */
    {{1,2},{5,6},{9,10},{3,4},{7,8},{12,13},{1,3},{5,7},{9,11},{2,4},{6,8},
     {12,14},{1,4},{5,8},{10,11},{2,3},{6,7},{13,14},{0,0}}, /* 14 */
    {{1,2},{5,6},{9,10}, {3,4},{7,8},{11,12},{13,14}, {1,3},{5,7},{9,11}, {2,4},{6,8},{10,12},{13,15},
     {1,4},{5,8},{9,12}, {2,3},{6,7},{10,11},{14,15},{0,0}}, /* 15 */
    {{1,2},{5,6},{9,10},{13,14},{3,4},{7,8},{11,12},{15,16},{1,3},{5,7},{9,11},{13,15},
     {2,4},{6,8},{10,12},{14,16},{1,4},{5,8},{9,12},{13,16},{2,3},{6,7},{10,11},{14,15},{0,0}}, /* 16 */
    {{4,5},{6,7},{10,11},{14,15}, {1,2},{8,9},{12,13}, {3,4},{6,8},{16,17}, {1,5},{10,12},{14,16}, {2,3},{7,9},
     {1,4},{11,13}, {3,5},{15,17}, {2,4},{6,9},{10,13}, {1,3},{11,12},{14,17}, {2,5},{7,8},{15,16},{0,0}}, /* 17 */
    {{4,5},{9,10},{11,12},{15,16}, {1,2},{6,7},{13,14}, {3,4},{8,9},{17,18}, {1,5},{6,10},{11,13}, {2,3},{7,8},{15,17},
     {1,4},{6,9},{12,14}, {3,5},{8,10},{16,18}, {2,4},{7,9},{11,14}, {1,3},{6,8},{15,18}, {2,5},{7,10},{12,13},{16,17},{0,0}}, /* 18 */
    {{4,5},{9,10},{14,15},{16,17}, {1,2},{6,7},{11,12},{18,19}, {3,4},{8,9},{13,14}, {1,5},{6,10},{11,15},{16,18}, {2,3},{7,8},{12,13},
     {1,4},{6,9},{11,14},{17,19}, {3,5},{8,10},{13,15}, {2,4},{7,9},{12,14},{16,19}, {1,3},{6,8},{11,13}, {2,5},{7,10},{12,15},{17,18},{0,0}}, /* 19 */
    {{4,5},{9,10},{14,15},{19,20}, {1,2},{6,7},{11,12},{16,17}, {3,4},{8,9},{13,14},{18,19},
     {1,5},{6,10},{11,15},{16,20}, {2,3},{7,8},{12,13},{17,18}, {1,4},{6,9},{11,14},{16,19},
     {3,5},{8,10},{13,15},{18,20}, {2,4},{7,9},{12,14},{17,19}, {1,3},{6,8},{11,13},{16,18}, {2,5},{7,10},{12,15},{17,20},{0,0}} /* 20 */
};

const guint french_num_matches[NUM_TABLES][NUM_FRENCH] = {
    {11, 23, 43, 79, 147}, // double repechage
    {11, 23, 43, 79},  // dubbelt aaterkval
    {11, 27, 59, 123}, // direct aaterkval
    {11, 27, 59, 123}, // est klass d
    { 7, 15, 31, 63},  // no repechage
    {11, 19, 37, 71},  // enkelt aaterkval
    {13, 29, 43, 79},  // Eliminatoria doble perdida
    /*{11, 23, 39, 71},*/ // Eliminatoria repesca doble inicio
    {11, 19, 35, 67, 131}, // Eliminatoria repesca doble = IJF
    {11, 19, 35, 67},  // Eliminatoria repesca simple
    {13, 29, 61, 125}, // modified double elimination
    {12, 24, 44, 80},  // double repechage one bronze
    {13, 29, 61, 125}, // double lost
    {11, 27, 59, 123}, // gbr knock out
    {11, 27, 59, 123}, // den double elimination
    {12, 28, 60, 124}  // est klass d one bronze
};

const gint medal_matches[NUM_TABLES][NUM_FRENCH][3] = {
    {{9,10,11}, {21,22,23}, {41,42,43}, {77,78,79}, {145,146,147}},    // double repechage
    {{9,10,11}, {21,22,23}, {41,42,43}, {77,78,79}},    // dubbelt aaterkval
    {{9,10,11}, {25,26,27}, {57,58,59}, {121,122,123}}, // direkt aaterval
    {{9,10,11}, {25,26,27}, {57,58,59}, {121,122,123}}, // estonian D klass
    {{5,6,7},   {13,14,15}, {29,30,31}, {61,62,63}},    // no repechage
    {{9,10,11}, {17,18,19}, {35,36,37}, {69,70,71}},    // enkelt aaterkval
    {{11,12,13}, {27,28,29}, {41,42,43}, {77,78,79}},   // Eliminatoria doble perdida
    /*{{9,10,11}, {21,22,23}, {37,38,39}, {69,70,71}},*/    // Eliminatoria repesca doble inicio
    {{9,10,11}, {17,18,19}, {33,34,35}, {65,66,67}, {129,130,131}},    // Eliminatoria repesca doble = IJF
    {{9,10,11}, {17,18,19}, {33,34,35}, {65,66,67}},    // Eliminatoria repesca simple
    {{0,13,12}, {0,29,28}, {0,61,60}, {0,125,124}},     // modified double elimination
    {{11,0,12}, {23,0,24}, {43,0,44}, {79,0,80}},       // double repechage one bronze
    {{11,12,13},{27,28,29}, {59,60,61}, {123,124,125}}, // double lost
    {{9,10,11}, {25,26,27}, {57,58,59}, {121,122,123}}, // gbr knock out
    {{9,10,11}, {25,26,27}, {57,58,59}, {121,122,123}}, // den double elimination
    {{11,0,12}, {27,0,28}, {59,0,60}, {123,0,124}}      // estonian D klass one bronze
};

gboolean one_bronze(gint table, gint sys)
{
    return (medal_matches[table][sys][1] == 0 ||
            medal_matches[table][sys][0] == 0);
}

gint get_matchnum_by_pos(struct compsys systm, gint pos, gint num)
{
    gint sys;
    gint table;

    // for the pools pos = 1 means last match, pos = 2 is the second last etc.

    switch (systm.system) {
    case SYSTEM_POOL:
    case SYSTEM_BEST_OF_3:
        return num_matches(systm.system, systm.numcomp) + 1 - pos;

    case SYSTEM_DPOOL:
        if (pos == 1)
            return num_matches(systm.system, systm.numcomp) + 3;
        else if (pos == 3 && num == 1)
            return num_matches(systm.system, systm.numcomp) + 1;
        else if (pos == 3 && num == 2)
            return num_matches(systm.system, systm.numcomp) + 2;
        return 0;

    case SYSTEM_QPOOL:
        if (pos == 1)
            return num_matches(systm.system, systm.numcomp) + 7;
        else if (pos == 3 && num == 1)
            return num_matches(systm.system, systm.numcomp) + 5;
        else if (pos == 3 && num == 2)
            return num_matches(systm.system, systm.numcomp) + 6;
        return 0;

    case SYSTEM_DPOOL2:
        return num_matches(systm.system, systm.numcomp) +
            num_matches(SYSTEM_POOL, 4) + 1 - pos;

    case SYSTEM_DPOOL3:
        if (pos == 1)
            return num_matches(systm.system, systm.numcomp) + 2;
        else if (pos == 3)
            return num_matches(systm.system, systm.numcomp) + 1;
        return 0;

    case SYSTEM_FRENCH_8:
    case SYSTEM_FRENCH_16:
    case SYSTEM_FRENCH_32:
    case SYSTEM_FRENCH_64:
    case SYSTEM_FRENCH_128:
    case SYSTEM_FRENCH_256:
        sys = systm.system - SYSTEM_FRENCH_8;
        table = systm.table;

        if (pos == 1)
            return medal_matches[table][sys][2];

        if (table == TABLE_MODIFIED_DOUBLE_ELIMINATION) {
            if (pos == 2)
                return medal_matches[table][sys][1];

            if (pos == 3 && num == 1)
                return -medal_matches[table][sys][1];

            return 0;
        } else if (table == TABLE_DOUBLE_LOST) {
            if (pos == 2)
                return -medal_matches[table][sys][2];

            if (pos == 3 && num == 1)
                return -medal_matches[table][sys][0];

            if (pos == 3 && num == 2)
                return -medal_matches[table][sys][1];

            if (pos == 5) {
                // for drawing technical purposes order of fights may vary
                int x = (num == 1) ? 0 : 1;
                int match1 = french_matches[table][sys][medal_matches[table][sys][x]][0];
                int match2 = french_matches[table][sys][medal_matches[table][sys][x]][1];
                if (match1 > match2)
                    return -match1;
                else
                    return -match2;
            }

            if (pos == 7) {
                // for drawing technical purposes order of fights may vary
                int x = (num == 1) ? 0 : 1;
                int match1 = french_matches[table][sys][medal_matches[table][sys][x]][0];
                int match2 = french_matches[table][sys][medal_matches[table][sys][x]][1];
                if (match1 > match2)
                    return -french_matches[table][sys][match1][0];
                else
                    return -french_matches[table][sys][match2][0];
            }

            return 0;
        }

        if (pos == 2)
            return -medal_matches[table][sys][2];

        if (pos == 3 && num == 1)
            return medal_matches[table][sys][0];

        if (pos == 3 && num == 2)
            return medal_matches[table][sys][1];

        if (pos == 4)
            return -medal_matches[table][sys][0];

        if (pos == 5 && num == 1) {
            if (medal_matches[table][sys][1])
                return -medal_matches[table][sys][0];

            return -french_matches[table][sys][medal_matches[table][sys][0]][0];
        }

        if (pos == 5 && num == 2) {
            if (medal_matches[table][sys][1])
                return -medal_matches[table][sys][1];

            return -french_matches[table][sys][medal_matches[table][sys][0]][1];
        }

        if (pos == 7 && num == 1) {
            return -french_matches[table][sys][medal_matches[table][sys][0]][0];
        }

        if (pos == 7 && num == 2) {
            return -french_matches[table][sys][medal_matches[table][sys][1]][0];
        }
        break;
    } // switch

    return 0;
}

gint get_abs_matchnum_by_pos(struct compsys systm, gint pos, gint num)
{
    gint m = get_matchnum_by_pos(systm, pos, num);

    if (m < 0)
        return -m;

    return m;
}

const gchar french_64_matches_to_page[NUM_TABLES][NUM_MATCHES] = {
{ // double repechage
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 9 // don't draw match 79
},{ // dubbelt aaterkval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 2, 2, 0, 1, 2, 2, 9 // don't draw match 79
},{ // direkt aaterval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  41,42,43,44,45,46,47,48,49,50 */
    2, 2, 2, 2, 2, 2, 2, 2, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    1, 1, 1, 1, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 1, 1, 1, 1, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 0, 0, 1, 1,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 2, 2, 2, 2, 0, 1,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  121,122,123 */
    2, 2, 9
},{ // estonian D klass
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
    /*  51,52,53,54,55,56,57,58,59,60 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 1, 1, 1, 1, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 0, 0, 1, 1, 2, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 0, 1, 2, 2,
    /*  121,122,123 */
    2, 2, 9
},{ // no repechage
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  91,92,93,94,95,96,97,98,99,100 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  101,102,103,104,105,106,107,108,109,110 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  111,112,113,114,115,116,117,118,119,120 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  121,122,123 */
    0, 0, 0
},{ // enkelt aaterkval
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    9
},{ // Eliminatoria doble perdida
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    2, 2, 0, 1, 2, 2, 2, 2, 9 // don't draw match 79
},
#if 0 // same as finnish repechage
{ // Eliminatoria repesca doble inicio
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 0, 1, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79    */
    9
},
#endif
{ // Eliminatoria repesca doble
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67 */
    2, 2, 0, 1, 2, 2, 9
},{ // Eliminatoria repesca simple
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67 */
    0, 1, 2, 2, 2, 2, 9
},{ // modified double elimination
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  41,42,43,44,45,46,47,48,49,50 */
    2, 2, 2, 2, 2, 2, 2, 2, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    1, 1, 1, 1, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80    */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    2, 2, 2, 2, 2, 2, 2, 2, 0, 0,
    /*  91,92,93,94,95,96,97,98,99,100 */
    0, 0, 1, 1, 1, 1, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 2, 2, 2, 2, 0, 0,
    /*  111,112,113,114,115,116,117,118,119,120 */
    1, 1, 2, 2, 2, 2, 2, 2, 0, 1,
    /*  121,122,123,124,125 */
    3, 3, 3, 3, 3
},{ // double repechage one bronze
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  21,22,23,24,25,26,27,28,29,30 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  31,32,33,34,35,36,37,38,39,40 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80    */
    2, 2, 0, 1, 2, 2, 2, 2, 2, 9 // don't draw match 80
}, { // double lost
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
        0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
        1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
        1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
        0, 0, 2, 2, 2, 2, 1, 1, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
        2, 2, 2, 2, 0, 0, 0, 0, 1, 1,
    /*  71,72,73,74,75,76,77,78,79,80 */
        1, 1, 0, 0, 0, 0, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
        1, 1, 1, 1, 2, 2, 2, 2, 0, 0,
    /*  91,92,93,94,95,96,97,98,99,100 */
        2, 2, 1, 1, 2, 2, 0, 0, 1, 1,
    /*  101,102,103,104,105,106,107,108,109,110 */
        0, 0, 2, 2, 1, 1, 2, 2, 0, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
        1, 2, 0, 2, 1, 2, 0, 1, 2, 2,
    /*  121,122,123,124,125 */
        2, 2, 2, 2, 2
},{ // gbr knock out
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
    /*  51,52,53,54,55,56,57,58,59,60 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 1, 1, 1, 1, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 0, 0, 1, 1, 2, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 0, 1, 2, 2,
    /*  121,122,123 */
    2, 2, 9
},{ // den double elimination
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
    /*  51,52,53,54,55,56,57,58,59,60 */
    0, 0, 1, 1, 1, 1, 0, 0, 1, 1,
    /*  61,62,63,64,65,66,67,68,69,70 */
    0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  121,122,123 */
    2, 2, 9
},{ // estonian D klass one bronze
    0,
    /*  01,02,03,04,05,06,07,08,09,10 */
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  11,12,13,14,15,16,17,18,19,20 */
    0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
    /*  21,22,23,24,25,26,27,28,29,30 */
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    /*  31,32,33,34,35,36,37,38,39,40 */
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    /*  41,42,43,44,45,46,47,48,49,50 */
    1, 1, 1, 1, 1, 1, 1, 1, 2, 2,
    /*  51,52,53,54,55,56,57,58,59,60 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  61,62,63,64,65,66,67,68,69,70 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  71,72,73,74,75,76,77,78,79,80 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  81,82,83,84,85,86,87,88,89,90 */
    0, 0, 0, 0, 1, 1, 1, 1, 2, 2,
    /*  91,92,93,94,95,96,97,98,99,100 */
    2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
    /*  101,102,103,104,105,106,107,108,109,110 */
    2, 2, 2, 2, 0, 0, 1, 1, 2, 2,
    /*  111,112,113,114,115,116,117,118,119,120 */
    2, 2, 2, 2, 2, 2, 0, 1, 2, 2,
    /*  121,122,123,124 */
    2, 2, 2, 9
}
};

const gchar french_128_matches_to_page[NUM_TABLES][NUM_MATCHES] = {
{ // double repechage
    0,
    /* 01,02,03,04,05,06,07,08,09,10 */
    0,     0, 0, 0, 0, 0, 0, 0, 0, 0,
    /* 11,12,13,14,15,16,17,18,19,20 */
    0,     0, 0, 0, 0, 0, 1, 1, 1, 1,
    /* 21,22,23,24,25,26,27,28,29,30 */
    1,     1, 1, 1, 1, 1, 1, 1, 1, 1,
    /* 31,32,33,34,35,36,37,38,39,40 */
    1,     1, 2, 2, 2, 2, 2, 2, 2, 2,
    /* 41,42,43,44,45,46,47,48,49,50 */
    2,     2, 2, 2, 2, 2, 2, 2, 3, 3,
    /* 51,52,53,54,55,56,57,58,59,60 */
    3,     3, 3, 3, 3, 3, 3, 3, 3, 3,
    /* 61,62,63,64,65,66,67,68,69,70 */
    3,     3, 3, 3, 0, 0, 0, 0, 0, 0,
    /* 71,72,73,74,75,76,77,78,79,80 */
    0,     0, 1, 1, 1, 1, 1, 1, 1, 1,
    /* 81,82,83,84,85,86,87,88,89,90 */
    2,     2, 2, 2, 2, 2, 2, 2, 3, 3,
    /* 91,92,93,94,95,96,97,98,99,100 */
    3,     3, 3, 3, 3, 3, 0, 0, 0, 0,
    /* 101,102,103,104,105,106,107,108,109,110 */
    1,      1,  1,  1,  2,  2,  2,  2,  3,  3,
    /* 111,112,113,114,115,116,117,118,119,120 */
    3,      3,  0,  0,  1,  1,  2,  2,  3,  3,
    /* 121,122,123,124,125,126,127,128,129,130 */
    0,      1,  2,  3,  4,  4,  4,  4,  4,  4,
    /* 131,132,133,134,135,136,137,138,139,140 */
    4,      4,  4,  4,  4,  4,  4,  4,  4,  4,
    /* 141,142,143,144,145,146,147,148,149,150 */
    4,      4,  4,  4,  4,  4,  4
}, {}, {}, {}, {}, {}, {},
{ // IJF = repesca doble
    0,
    /* 01,02,03,04,05,06,07,08,09,10 */
    0,     0, 0, 0, 0, 0, 0, 0, 0, 0,
    /* 11,12,13,14,15,16,17,18,19,20 */
    0,     0, 0, 0, 0, 0, 1, 1, 1, 1,
    /* 21,22,23,24,25,26,27,28,29,30 */
    1,     1, 1, 1, 1, 1, 1, 1, 1, 1,
    /* 31,32,33,34,35,36,37,38,39,40 */
    1,     1, 2, 2, 2, 2, 2, 2, 2, 2,
    /* 41,42,43,44,45,46,47,48,49,50 */
    2,     2, 2, 2, 2, 2, 2, 2, 3, 3,
    /* 51,52,53,54,55,56,57,58,59,60 */
    3,     3, 3, 3, 3, 3, 3, 3, 3, 3,
    /* 61,62,63,64,65,66,67,68,69,70 */
    3,     3, 3, 3, 0, 0, 0, 0, 0, 0,
    /* 71,72,73,74,75,76,77,78,79,80 */
    0,     0, 1, 1, 1, 1, 1, 1, 1, 1,
    /* 81,82,83,84,85,86,87,88,89,90 */
    2,     2, 2, 2, 2, 2, 2, 2, 3, 3,
    /* 91,92,93,94,95,96,97,98,99,100 */
    3,     3, 3, 3, 3, 3, 0, 0, 0, 0,
    /* 101,102,103,104,105,106,107,108,109,110 */
    1,      1,  1,  1,  2,  2,  2,  2,  3,  3,
    /* 111,112,113,114,115,116,117,118,119,120 */
    3,      3,  0,  0,  1,  1,  2,  2,  3,  3,
    /* 121,122,123,124,125,126,127,128,129,130 */
    0,      1,  2,  3,  4,  4,  4,  4,  4,  4,
    /* 131,132,133,134,135,136,137,138,139,140 */
    4
}, {}, {}, {}
};

const gint result_y_position[NUM_TABLES][NUM_FRENCH] = {
    {4, 12, 28, 0, 0},
    {4, 12, 28, 0},
    {4, 22, 50, 0},
    {4, 22, 54, 0},
    {0, 0, 0, 0},
    {4, 12, 30, 0},
    {4, 12, 28, 0},
    /*{4, 12, 28, 0},*/
    {4, 12, 28, 0},
    {4, 16, 28, 0},
    {4, 16, 48, 0},
    {4, 12, 28, 0},
    {7, 12, 23, 0},
    {4, 22, 54, 0},
    {4, 14, 30, 0},
    {4, 22, 54, 0}
};

const gint repechage_start[NUM_TABLES][NUM_FRENCH][2] = {
    {{7,0}, {0,0},   {29,0},  {0,63}, {0,125}},  // double repechage
    {{7,0}, {0,0},   {29,0},  {0,63}},  // dubbelt aaterkval
    {{7,0}, {0,0},   {17,0},  {0,0}},   // direkt aaterval
    {{7,0}, {0,0},   {0,0},   {0,0}},   // estonian D klass
    {{0,0}, {0,0},   {0,0},   {0,0}},   // no repechage
    {{7,0}, {15,16}, {31,32}, {0,64}},  // enkelt aaterkval
    {{5,0}, {9,0},   {29,0},  {0,63}},  // Eliminatoria doble perdida
    /*{{7,0}, {0,0},   {29,0},  {0,61}},*/  // Eliminatoria repesca doble inicio
    {{7,0}, {0,0},   {29,0},  {0,61}, {0,125}},  // Eliminatoria repesca doble = IJF
    {{7,0}, {0,0},   {29,0},  {0,63}},  // Eliminatoria repesca simple
    {{7,0}, {0,0},   {29,0},  {0,0}},   // modified double elimination
    {{7,0}, {0,0},   {29,0},  {0,63}},  // double repechage one bronze
    {{7,0}, {15,0},  {31,0}, {73,81}}, // double lost
    {{7,0}, {0,0},   {0,0},   {0,0}},   // gbr knock out
    {{7,0}, {0,0},   {0,0},   {0,0}},  // den double elimination
    {{7,0}, {0,0},   {0,0},   {0,0}}   // estonian D klass one bronze
};

const gint french_matches[NUM_TABLES][NUM_FRENCH][NUM_MATCHES][2] = {
    /* Double repechage */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 9,10},{11,12},{13,14},{15,16},
	    /*  21,     22,     23 */
	    {19,-18},{20,-17},{17,18}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{25,26},{27,28},{33,34},{35,36},
	    /*  41,     42,     43 */
	    {39,-38},{40,-37},{37,38}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{57,58},{59,60},{69,70},{71,72},{75,-74},{76,-73},{73,74}
	},
	/* <= 128 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79      80 */
	    {13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},
	    /*  81,     82,     83,     84,     85,     86,     87,     88,     89      90 */
	    {33,34},{35,36},{37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},
	    /*  91,     92,     93,     94,     95,     96,     97,     98,     99     100 */
	    {53,54},{55,56},{57,58},{59,60},{61,62},{63,64},{65,66},{67,68},{69,70},{71,72},
	    /* 101,    102,    103,    104,    105,    106,    107,    108,    109     110 */
	    {73,74},{75,76},{77,78},{79,80},{81,82},{83,84},{85,86},{87,88},{89,90},{91,92},
	    /* 111,    112,    113,    114,    115,    116,    117,    118,    119     120 */
	    {93,94},{95,96},{97,98},{99,100},{101,102},{103,104},{105,106},{107,108},{109,110},{111,112},
	    /* 121,    122,    123,    124,    125,    126,    127,    128,    129     130 */
	    {113,114},{115,116},{117,118},{119,120},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{125, 0},{126, 0},
	    /* 131,    132,    133,    134,    135,    136,    137,    138,    139     140 */
	    {127, 0},{128, 0},{129, 0},{130, 0},{131, 0},{132, 0},{133,-121},{134,-122},{135,-123},{136,-124},
	    /* 141,    142,    143,    144,    145,    146,    147                         */
	    {121,122},{123,124},{137,138},{139,140},{143,-142},{144,-141},{141,142}
	}
    },
    /* Swedish Dubbelt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 13,14},{15,16},{9,10},{11,12},
	    /*  21,     22,     23 */
	    {17,-20},{18,-19},{19,20}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{33,34},{35,36},{25,26},{27,28},
	    /*  41,     42,     43 */
	    {37,-40},{38,-39},{39,40}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{69,70},{71,72},{57,58},{59,60},{73,-76},{74,-75},{75,76}
	}
    },
    /* Swedish Direkt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    {-5,-6},{-7,-8},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,-14},{10,-13},{11,-16},{12,-15},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    {13,14},{15,16},{17,18},{19,20},{23,-22},{24,-21},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{-5,-6},{-7,-8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    {-9,-10},{-11,-12},{-13,-14},{-15,-16},{1,2},{3,4},{5,6},{ 7, 8},{ 9,10},{11,12},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {13,14},{15,16},{17,-26},{18,-25},{19,-28},{20,-27},{21,-30},{22,-29},{23,-32},{24,-31},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {25,26},{27,28},{29,30},{31,32},{33,34},{35,36},{37,38},{39,40},{41,42},{43,44},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {45,-42},{46,-41},{47,-44},{48,-43},{51,52},{53,54},{55,-50},{56,-49},{49,50}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   {-1,-2},   {-3,-4},   {-5,-6},   {-7,-8},   {-9,-10}, {-11,-12},{-13,-14},{-15,-16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {-17,-18}, {-19,-20}, {-21,-22}, {-23,-24}, {-25,-26}, {-27,-28}, {-29,-30},{-31,-32},{ 1, 2},  { 3, 4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    { 5, 6},   { 7, 8},   { 9, 10},  { 11, 12}, { 13, 14}, { 15, 16}, { 17, 18},{ 19, 20},{ 21, 22},{ 23, 24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    { 25, 26}, { 27, 28}, { 29, 30}, { 31, 32}, {33,-50},  {34,-49},  {35,-52}, {36,-51}, {37,-54}, {38,-53},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {39,-56},  {40,-55},  {41,-58},  {42,-57},  {43,-60},  {44,-59},  {45,-62}, {46,-61}, {47,-64}, {48,-63},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {49,50},   {51,52},   {53,54},   {55,56},   {57,58},   {59,60},   {61,62},  {63,64},  {65,66},  {67,68},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {69,70},   {71,72},   {73,74},   {75,76},   {77,78},   {79,80},   {81,82},  {83,84},  {85,86},  {87,88},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {89,-82},  {90,-81},  {91,-84},  {92,-83},  {93,-86},  {94,-85},  {95,-88}, {96,-87}, {97,98},  {99,100},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {101,102}, {103,104}, {105,106}, {107,108}, {111,-98}, {112,-97}, {113,-100},{114,-99},{115,116},{117,118},
	    /* 121,       122,       123      */
	    {119,-110},{120,-109},{109,110}
	}
    },
    /* Estonian for D klass */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{-1,-2},{-3,-4},{-5,-6},{-7,-8},{13,-10},{14,-9},{15,-12},{16,-11},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    { 9,10},{11,12},{17,18},{19,20},{23,-22},{24,-21},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{-5,-6},{-7,-8},{-1,-2},{-3,-4},{-13,-14},{-15,-16},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {-9,-10},{-11,-12},{25,-17},{26,-18},{27,-19},{28,-20},{29,-21},{30,-22},{31,-23},{32,-24},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{33,34},{35,36},{37,38},{39,40},{45,-42},{46,-41},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {47,-44},{48,-43},{41,42},{43,44},{49,50},{51,52},{55,-54},{56,-53},{53,54}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9,10},  {11,12},  {13,14},  {15,16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {17,18},   {19,20},   {21,22},   {23,24},   {25,26},   {27,28},   {29,30},  {31,32},  {-1,-2},  {-3,-4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {-5,-6},   {-7,-8},   {-9,-10},  {-11,-12}, {-13,-14}, {-15,-16}, {-17,-18},{-19,-20},{-21,-22},{-23,-24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    {-25,-26}, {-27,-28}, {-29,-30}, {-31,-32}, {49,-35},  {50,-36},  {51,-33}, {52,-34}, {53,-39}, {54,-40},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {55,-37},  {56,-38},  {57,-43},  {58,-44},  {59,-41},  {60,-42},  {61,-47}, {62,-48}, {63,-45}, {64,-46},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {33,34},   {35,36},   {37,38},   {39,40},   {41,42},   {43,44},   {45,46},  {47,48},  {65,66},  {67,68},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {69,70},   {71,72},   {73,74},   {75,76},   {77,78},   {79,80},   {89,-83}, {90,-84}, {91,-81}, {92,-82},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {93,-87},  {94,-88},  {95,-85},  {96,-86},  {81,82},   {83,84},   {85,86},  {87,88},  {97,98},  {99,100},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {101,102}, {103,104}, {109,-105},{110,-106},{111,-107},{112,-108},{105,106},{107,108},{113,114},{115,116},
	    /* 121,       122,       123      */
	    {119,-118},{120,-117},{117,118}
	}
    },
    /* No repechage */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    {57,58},{59,60},{61,62}
	}
    },
    /* Swedish Enkelt aaterkval */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{ 0, 0},{ 0, 0},{ 15,-13},{16,-14},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{31, 0},{32, 0},{33,-29},{34,-30},{29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    {57,58},{59,60},{ 0, 0},{ 0, 0},{63, 0},{64, 0},{65, 0},{66, 0},{67,-62},{68,-61},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {61,62}
	}
    },
    /* Eliminatoria doble perdida */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{ 1, 2},{ 3, 4},{ 5,-8},{ 6,-7},
	    /*  11,     12,     13 */
	    { 7,10},{ 8, 9},{11,12}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    {-5,-6},{-7,-8},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,-14},{10,-13},{11,-16},{12,-15},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29 */
	    {13,14},{15,16},{17,18},{19,20},{23,-22},{24,-21},{21,26},{22,25},{27,28}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{25,26},{27,28},{33,34},{35,36},
	    /*  41,     42,     43 */
	    {39,-38},{40,-37},{37,38}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79         */
	    {67,-59},{68,-60},{57,58},{59,60},{69,70},{71,72},{75,-74},{76,-73},{73,74}
	}
    },
#if 0
    /* Eliminatoria repesca doble inicio */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 9,10},{11,12},{13,14},{15,16},
	    /*  21,     22,     23 */
	    {19,-18},{20,-17},{17,18}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39 */
	    { 0, 0},{ 0, 0},{25,26},{27,28},{29,30},{31,32},{35,-34},{36,-33},{33,34}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{57,58},{59,60},{61,62},{63,64},{67,-66},{68,-65},
	    /*  71 */
	    {65,66}
	}
    },
#endif
    /* Eliminatoria repesca doble = IJF */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{ 1, 2},{ 3, 4},{ 5,-8},{ 6,-7},
	    { 7, 8}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19 */
	    { 5, 6},{ 7, 8},{-9,-10},{-11,-12},{ 9,10},{11,12},{13,-16},{14,-15},{15,16}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{-25,-26},{-27,-28},
	    /*  31,     32,     33,     34,     35 */
	    {25,26},{27,28},{29,-32},{30,-31},{31,32}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67 */
	    {-57,-58},{-59,-60},{57,58},{59,60},{61,-64},{62,-63},{63,64}
	},
	/* <= 128 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79      80 */
	    {13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},
	    /*  81,     82,     83,     84,     85,     86,     87,     88,     89      90 */
	    {33,34},{35,36},{37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},
	    /*  91,     92,     93,     94,     95,     96,     97,     98,     99     100 */
	    {53,54},{55,56},{57,58},{59,60},{61,62},{63,64},{65,66},{67,68},{69,70},{71,72},
	    /* 101,    102,    103,    104,    105,    106,    107,    108,    109     110 */
	    {73,74},{75,76},{77,78},{79,80},{81,82},{83,84},{85,86},{87,88},{89,90},{91,92},
	    /* 111,    112,    113,    114,    115,    116,    117,    118,    119     120 */
	    {93,94},{95,96},{97,98},{99,100},{101,102},{103,104},{105,106},{107,108},{109,110},{111,112},
	    /* 121,    122,    123,    124,    125,    126,    127,    128,    129     130 */
	    {113,114},{115,116},{117,118},{119,120},{-121,-122},{-123,-124},{121,122},{123,124},{125,-128},{126,-127},
	    /* 131,    132,    133,    134,    135,    136,    137,    138,    139     140 */
	    {127,128}
	}
    },
    /* Eliminatoria repesca simple */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-5},{ 8,-6},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19  */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{ 0, 0},{ 0, 0},{15,-13},{16,-14},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35 */
	    { 0, 0},{ 0, 0},{31,-29},{32,-30},{29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67 */
	    {57,58},{59,60},{ 0, 0},{ 0, 0},{63,-61},{64,-62},{61,62}
	}
    },
    /* Modified double elimination */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{ 1, 2},{ 3, 4},{ 5,-8},{ 6,-7},
	    { 9,10},{ 7, 8},{11,-12}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    {-5,-6},{-7,-8},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,-13},{10,-14},{11,-15},{12,-16},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29 */
	    {17,18},{19,20},{13,14},{15,16},{21,-24},{22,-23},{25,26},{23,24},{27,-28}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{-1,-2},{-3,-4},{-5,-6},{-7,-8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    {-9,-10},{-11,-12},{-13,-14},{-15,-16},{1,2},{3,4},{5,6},{7,8},{9,10},{11,12},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {13,14},{15,16},{17,-25},{18,-26},{19,-27},{20,-28},{21,-29},{22,-30},{23,-31},{24,-32},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {33,34},{35,36},{37,38},{39,40},{25,26},{27,28},{29,30},{31,32},{41,-45},{42,-46},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {43,-47},{44,-48},{45,46},{47,48},{49,50},{51,52},{55,-54},{56,-53},{57,58},{53,54},
	    /*  61  */
	    {59,-60}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   {-1,-2},   {-3,-4},   {-5,-6},   {-7,-8},   {-9,-10}, {-11,-12},{-13,-14},{-15,-16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {-17,-18}, {-19,-20}, {-21,-22}, {-23,-24}, {-25,-26}, {-27,-28}, {-29,-30},{-31,-32},{1,2},    {3,4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {5,6},     {7,8},     { 9, 10},  { 11, 12}, { 13, 14}, { 15, 16}, { 17, 18},{ 19, 20},{ 21, 22},{ 23, 24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    { 25, 26}, { 27, 28}, { 29, 30}, { 31, 32}, {33,-49},  {34,-50},  {35,-51}, {36,-52}, {37,-53}, {38,-54},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {39,-55},  {40,-56},  {41,-57},  {42,-58},  {43,-59},  {44,-60},  {45,-61}, {46,-62}, {47,-63}, {48,-46},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {65,66},   {67,68},   {69,70},   {71,72},   {73,74},   {75,76},   {77,78},  {79,80},  {49,50},  {51,52},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {53,54},   {55,56},   {57,58},   {59,60},   {61,62},   {63,64},   {81,-89}, {82,-90}, {83,-91}, {84,-92},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {85,-93},  {86,-94},  {87,-95},  {88,-96},  {97,98},   {99,100},  {101,102},{103,104},{89,90},  {91,92},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {93,94},   {95,96},   {105,-109},{106,-110},{107,-111},{108,-112},{113,114},{115,116},{109,110},{111,112},
	    /* 121,       122,       123,       124,       125  */
	    {117,-120},{118,-119},{121,122}, {119,120}, {123,-124}
	}
    },
    /* Double repechage one bronze */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 9,10}, { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 9,10},{11,12},{13,14},{15,16},
	    /*  21,     22,     23,     24 */
	    {19,-18},{20,-17},{21,22},{17,18}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{29, 0},{30, 0},{31, 0},{32, 0},{25,26},{27,28},{33,34},{35,36},
	    /*  41,     42,     43      44 */
	    {39,-38},{40,-37},{41,42},{37,38}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    { 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},{ 9,10},{11,12},{13,14},{15,16},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{25,26},{27,28},{29,30},{31,32},{33,34},{35,36},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {37,38},{39,40},{41,42},{43,44},{45,46},{47,48},{49,50},{51,52},{53,54},{55,56},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{61, 0},{62, 0},{63, 0},{64, 0},{65,-57},{66,-58},
	    /*  71,     72,     73,     74,     75,     76,     77,     78,     79      80 */
	    {67,-59},{68,-60},{57,58},{59,60},{69,70},{71,72},{75,-74},{76,-73},{77,78},{73,74}
	}
    },
    /* Double lost */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 9},{ 6,10},{11,12}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},{-5,-6},{-7,-8},{-1,-2},{-3,-4},{15,-9},{16,-10},
	    /*  21,     22,     23     24      25       26       27      28       29*/
	    {17,-11},{18,-12},{19,20},{21,22},{23,-14},{24,-13},{13,25},{14,26},{27,28}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,       33,     34,       35,     36,     37,     38,     39,     40 */
	    {-13,-14},{-15,-16},{-9,-10},{-11,-12},{-5,-6},{-7,-8},{-1,-2},{-3,-4},{31,-21},{32,-22},
	    /*  41,     42,     43,     44,      45,      46,      47,     48,     49,     50 */
            {33,-23},{34,-24},{35,-17},{36,-18},{37,-19},{38,-20},{39,40},{41,42},{43,44},{45,46},
	    /*  51,     52,     53,     54,      55,     56,     57,      58,      59,     60 */
            {47,-25},{48,-26},{49,-27},{50,-28},{51,52},{53,54},{55,-30},{56,-29},{30,58},{29,57},
	    /*  61,     62,     63,     64,     65,     66,     67,     68,     69,     70 */
            {60,59}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9, 10}, { 11, 12},{ 13, 14},{ 15, 16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    { 17, 18}, { 19, 20}, { 21, 22}, { 23, 24}, { 25, 26}, { 27, 28}, { 29, 30},{ 31, 32},{-29,-30},  {-31,-32},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
            {-25,-26}, {-27,-28}, {-21,-22}, {-23,-24}, {-17,-18}, {-19,-20}, {-13,-14}, {-15,-16}, { -9,-10}, {-11,-12},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
            { -5, -6}, { -7, -8}, { -1, -2}, { -3, -4}, { 33, 34}, { 35, 36}, { 37, 38}, { 39, 40}, { 41, 42}, { 43, 44},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
            { 45, 46}, { 47, 48}, { 49,-45}, { 50,-46}, { 51,-47}, { 52,-48}, { 53,-41}, { 54,-42}, { 55,-43}, { 56,-44},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
            { 57,-37}, { 58,-38}, { 59,-39}, { 60,-40}, { 61,-33}, { 62,-34}, { 63,-35}, { 64,-36}, { 73, 74}, { 75, 76},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
            { 77, 78}, { 79, 80}, { 81, 82}, { 83, 84}, { 85, 86}, { 87, 88}, { 65, 66}, { 67, 68}, { 69, 70}, { 71, 72},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
            { 89,-69}, { 90,-70}, { 91,-71}, { 92,-72}, { 93,-65}, { 94,-66}, { 95,-67}, { 96,-68}, {101,102}, {103,104},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
            {105,106}, {107,108}, {109,-97}, {110,-98}, {111,-99}, {112,-100}, { 97, 98}, { 99,100}, {113,114}, {115,116},
	    /* 121,       122,       123        124        125 */
            {119,-118}, {120,-117}, {121,117}, {122,118}, {123,124}
	}
    },
    /* GBR knock out */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{-1,-2},{-3,-4},{-5,-6},{-7,-8},{13,-11},{14,-12},{15,-9},{16,-10},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    { 9,10},{11,12},{17,18},{19,20},{23,-21},{24,-22},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{-1,-2},{-3,-4},{-5,-6},{-7,-8},{-9,-10},{-11,-12},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {-13,-14},{-15,-16},{25,-19},{26,-20},{27,-17},{28,-18},{29,-23},{30,-24},{31,-21},{32,-22},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{33,34},{35,36},{37,38},{39,40},{45,-44},{48,-41},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {46,-43},{47,-42},{41,42},{43,44},{49,50},{51,52},{55,-54},{56,-53},{53,54}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9,10},  {11,12},  {13,14},  {15,16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {17,18},   {19,20},   {21,22},   {23,24},   {25,26},   {27,28},   {29,30},  {31,32},  {-1,-2},  {-3,-4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {-5,-6},   {-7,-8},   {-9,-10},  {-11,-12}, {-13,-14}, {-15,-16}, {-17,-18},{-19,-20},{-21,-22},{-23,-24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    {-25,-26}, {-27,-28}, {-29,-30}, {-31,-32}, {49,-35},  {50,-36},  {51,-33}, {52,-34}, {53,-39}, {54,-40},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {55,-37},  {56,-38},  {57,-43},  {58,-44},  {59,-41},  {60,-42},  {61,-47}, {62,-48}, {63,-45}, {64,-46},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {33,34},   {35,36},   {37,38},   {39,40},   {41,42},   {43,44},   {45,46},  {47,48},  {65,66},  {67,68},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {69,70},   {71,72},   {73,74},   {75,76},   {77,78},   {79,80},   {89,-83}, {90,-84}, {91,-81}, {92,-82},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {93,-87},  {94,-88},  {95,-85},  {96,-86},  {81,82},   {83,84},   {85,86},  {87,88},  {97,98},  {99,100},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {101,102}, {103,104}, {109,-105},{110,-106},{111,-107},{112,-108},{105,106},{107,108},{113,114},{115,116},
	    /* 121,       122,       123      */
	    {119,-118},{120,-117},{117,118}
	}
    },
    /* Danish double elimination */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    { 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{ 9,10},{11,12},   {0,0},  {0,0},  {0,0},  {0,0},{15,-10},{16,-9},
	    /*  21,     22,     23,     24,     25,     26,     27  */
	    {17,-12},{18,-11},{19,20},{21,22},{23,-14},{24,-13},{13,14}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{17,18},{19,20},{21,22},{23,24},{25,26},{27,28},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {0,0},    {0,0},  {0,0},  {0,0},  {0,0},  {0,0},  {0,0},  {0,0}, {31,0}, {32,0},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {33,0},  {34,0}, {35,0}, {36,0}, {37,0}, {38,0},{39,40},{41,42},{43,44},{45,46},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,   */
	    {47,-26},{48,-25},{49,-28},{50,-27},{51,52},{53,54},{55,-30},{56,-29},{29,30}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9,10},  {11,12},  {13,14},  {15,16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {17,18},   {19,20},   {21,22},   {23,24},   {25,26},   {27,28},   {29,30},  {31,32},  {33,34},  {35,36},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {37,38},   {39,40},   {41,42},   {43,44},   {45,46},   {47,48},   {49,50},  {51,52},  {53,54},  {55,56},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    {57,58},   {59,60},    {0, 0},    {0, 0},    {0, 0},    {0, 0},    {0, 0},    {0, 0},  {0, 0},   {0, 0},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {0, 0},     {0, 0},    {0, 0},    {0, 0},    {0, 0},    {0, 0},    {0, 0},    {0, 0},  {63, 0},  {64, 0},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {65, 0},   {66, 0},   {67, 0},   {68, 0},   {69, 0},   {70, 0},   {71, 0},   {72, 0},   {73, 0},  {74, 0},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {75, 0},   {76, 0},   {77, 0},   {78, 0},   {79,80},   {81,82},   {83,84},   {85,86},   {87,88},  {89,90},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {91,92},   {93,94},   {95, 0},   {96, 0},   {97, 0},   {98, 0},   {99, 0},  {100, 0},  {101, 0},  {102, 0},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {103,104},{105,106},{107,108}, {109,110}, {111,-57}, {112,-58}, {113,-59}, {114,-60}, {115,116}, {117,118},
	    /* 121,       122,       123      */
            {119,-62}, {120,-61}, {61,62}
	}
    },
    /* Estonian for D klass one bronze */
    {
	/* 8 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{-1,-2},{-3,-4},{ 7,-6},{ 8,-5},
	    {9,10},{ 5, 6}
	},
	/* <= 16 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 5, 6},{ 7, 8},{-1,-2},{-3,-4},{-5,-6},{-7,-8},{13,-10},{14,-9},{15,-12},{16,-11},
	    /*  21,     22,     23,     24,     25,     26,     27,    28 */
	    { 9,10},{11,12},{17,18},{19,20},{23,-22},{24,-21},{25,26},{21,22}
	},
	/* <= 32 competitors */
	{
	    {0,0},
	    /*  01,     02,     03,     04,     05,     06,     07,     08,     09,     10 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},
	    /*  11,     12,     13,     14,     15,     16,     17,     18,     19,     20 */
	    { 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 0, 0},{ 1, 2},{ 3, 4},{ 5, 6},{ 7, 8},
	    /*  21,     22,     23,     24,     25,     26,     27,     28,     29,     30 */
	    { 9,10},{11,12},{13,14},{15,16},{-5,-6},{-7,-8},{-1,-2},{-3,-4},{-13,-14},{-15,-16},
	    /*  31,     32,     33,     34,     35,     36,     37,     38,     39,     40 */
	    {-9,-10},{-11,-12},{25,-17},{26,-18},{27,-19},{28,-20},{29,-21},{30,-22},{31,-23},{32,-24},
	    /*  41,     42,     43,     44,     45,     46,     47,     48,     49,     50 */
	    {17,18},{19,20},{21,22},{23,24},{33,34},{35,36},{37,38},{39,40},{45,-42},{46,-41},
	    /*  51,     52,     53,     54,     55,     56,     57,     58,     59,     60 */
	    {47,-44},{48,-43},{41,42},{43,44},{49,50},{51,52},{55,-54},{56,-53},{57,58},{53,54}
	},
	/* <= 64 competitors */
	{
	    {0,0},
	    /*  01,        02,        03,        04,        05,        06,        07,       08,       09,       10 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  11,        12,        13,        14,        15,        16,        17,       18,       19,       20 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  21,        22,        23,        24,        25,        26,        27,       28,       29,       30 */
	    { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},   { 0, 0},  { 0, 0},  { 0, 0},  { 0, 0},
	    /*  31,        32,        33,        34,        35,        36,        37,       38,       39,       40 */
	    { 0, 0},   { 0, 0},   { 1, 2},   { 3, 4},   { 5, 6},   { 7, 8},   { 9,10},  {11,12},  {13,14},  {15,16},
	    /*  41,        42,        43,        44,        45,        46,        47,       48,       49,       50 */
	    {17,18},   {19,20},   {21,22},   {23,24},   {25,26},   {27,28},   {29,30},  {31,32},  {-1,-2},  {-3,-4},
	    /*  51,        52,        53,        54,        55,        56,        57,       58,       59,       60 */
	    {-5,-6},   {-7,-8},   {-9,-10},  {-11,-12}, {-13,-14}, {-15,-16}, {-17,-18},{-19,-20},{-21,-22},{-23,-24},
	    /*  61,        62,        63,        64,        65,        66,        67,       68,       69,       70 */
	    {-25,-26}, {-27,-28}, {-29,-30}, {-31,-32}, {49,-35},  {50,-36},  {51,-33}, {52,-34}, {53,-39}, {54,-40},
	    /*  71,        72,        73,        74,        75,        76,        77,       78,       79        80  */
	    {55,-37},  {56,-38},  {57,-43},  {58,-44},  {59,-41},  {60,-42},  {61,-47}, {62,-48}, {63,-45}, {64,-46},
	    /*  81,        82,        83,        84,        85,        86,        87,       88,       89,       90  */
	    {33,34},   {35,36},   {37,38},   {39,40},   {41,42},   {43,44},   {45,46},  {47,48},  {65,66},  {67,68},
	    /*  91,        92,        93,        94,        95,        96,        97,       98,       99,      100  */
	    {69,70},   {71,72},   {73,74},   {75,76},   {77,78},   {79,80},   {89,-83}, {90,-84}, {91,-81}, {92,-82},
	    /* 101,       102,       103,       104,       105,       106,       107,      108,      109,      110 */
	    {93,-87},  {94,-88},  {95,-85},  {96,-86},  {81,82},   {83,84},   {85,86},  {87,88},  {97,98},  {99,100},
	    /* 111,       112,       113,       114,       115,       116,       117,      118,      119,      120 */
	    {101,102}, {103,104}, {109,-105},{110,-106},{111,-107},{112,-108},{105,106},{107,108},{113,114},{115,116},
	    /* 121,       122,       123        124 */
	    {119,-118},{120,-117},{121,122},{117,118}
	}
    }
};

static const gint system_menu_order[NUM_SYSTEMS] = {
    CAT_SYSTEM_DEFAULT,
    CAT_SYSTEM_BEST_OF_3,
    CAT_SYSTEM_POOL,
    CAT_SYSTEM_DPOOL,
    CAT_SYSTEM_DPOOL2,
    CAT_SYSTEM_DPOOL3,
    CAT_SYSTEM_QPOOL,
    CAT_SYSTEM_REPECHAGE,
    CAT_SYSTEM_ENKELT_AATERKVAL,
    CAT_SYSTEM_DUBBELT_AATERKVAL,
    CAT_SYSTEM_DIREKT_AATERKVAL,
    CAT_SYSTEM_EST_D_KLASS,
    CAT_SYSTEM_EST_D_KLASS_ONE_BRONZE,
    CAT_ESP_DOBLE_PERDIDA,
    /*CAT_ESP_REPESCA_DOBLE_INICIO,*/
    CAT_ESP_REPESCA_DOBLE,
    CAT_ESP_REPESCA_SIMPLE,
    CAT_SYSTEM_NO_REPECHAGE,
    CAT_MODIFIED_DOUBLE_ELIMINATION,
    CAT_SYSTEM_REPECHAGE_ONE_BRONZE,
    CAT_SYSTEM_DOUBLE_LOST,
    CAT_SYSTEM_GBR_KNOCK_OUT,
    CAT_SYSTEM_DEN_DOUBLE_ELIMINATION,
    CAT_SYSTEM_CUSTOM
};

const gint cat_system_to_table[NUM_SYSTEMS] = {
    0, 0, 0,
    TABLE_DOUBLE_REPECHAGE,
    TABLE_SWE_DUBBELT_AATERKVAL,
    TABLE_SWE_DIREKT_AATERKVAL,
    TABLE_EST_D_KLASS,
    TABLE_NO_REPECHAGE,
    TABLE_SWE_ENKELT_AATERKVAL,
    0,
    TABLE_ESP_DOBLE_PERDIDA,
    /*TABLE_ESP_REPESCA_DOBLE_INICIO,*/
    TABLE_ESP_REPESCA_DOBLE,
    TABLE_ESP_REPESCA_SIMPLE,
    TABLE_MODIFIED_DOUBLE_ELIMINATION,
    TABLE_DOUBLE_REPECHAGE_ONE_BRONZE,
    0,
    TABLE_DOUBLE_LOST,
    TABLE_GBR_KNOCK_OUT,
    0,
    TABLE_DEN_DOUBLE_ELIMINATION,
    TABLE_EST_D_KLASS_ONE_BRONZE,
    0, 0
};

struct compsys wish_to_system(gint sys, gint numcomp)
{
    struct compsys ret;

    ret.numcomp = numcomp;
    ret.wishsys = sys;

    if (system_wish_is_french(sys)) {
        if (numcomp <= 8) ret.system = SYSTEM_FRENCH_8;
        else if (numcomp <= 16) ret.system = SYSTEM_FRENCH_16;
        else if (numcomp <= 32) ret.system = SYSTEM_FRENCH_32;
        else if (numcomp <= 64) ret.system = SYSTEM_FRENCH_64;
        else if (numcomp <= 128) ret.system = SYSTEM_FRENCH_128;
        else ret.system = SYSTEM_FRENCH_256;

        ret.table = cat_system_to_table[sys];
    } else {
        ret.table = 0;

        switch (sys) {
        case CAT_SYSTEM_POOL: ret.system = SYSTEM_POOL; break;
        case CAT_SYSTEM_DPOOL: ret.system = SYSTEM_DPOOL; break;
        case CAT_SYSTEM_QPOOL: ret.system = SYSTEM_QPOOL; break;
        case CAT_SYSTEM_DPOOL2: ret.system = SYSTEM_DPOOL2; break;
        case CAT_SYSTEM_DPOOL3: ret.system = SYSTEM_DPOOL3; break;
        case CAT_SYSTEM_BEST_OF_3: ret.system = SYSTEM_BEST_OF_3; break;
        case CAT_SYSTEM_CUSTOM: ret.system = SYSTEM_CUSTOM; break;
        }
    }

    return ret;
}

gchar *get_system_description(gint index, gint competitors)
{
    struct compsys sys = get_system_for_category(index, competitors);

    switch (sys.system) {
    case SYSTEM_POOL:
        if (competitors == 1)
            return "";
        if (competitors == 2) {
            if (prop_get_int_val(PROP_THREE_MATCHES_FOR_TWO))
                return _("Best of 3");
            return _("One match");
        }
        return _("Pool");
    case SYSTEM_DPOOL: return _("Double Pool");
    case SYSTEM_QPOOL: return _("Quad Pool");
    case SYSTEM_DPOOL2: return _("Double Pool 2");
    case SYSTEM_DPOOL3: return _("Double Pool 3");
    case SYSTEM_BEST_OF_3: return _("Best of 3");
    case SYSTEM_CUSTOM:
        {
            struct custom_data *ct = get_custom_table(sys.table);
            if (ct) return ct->name_long;
            return _("Custom");
        }
    }

    if (system_is_french(sys.system)) {
        if (sys.table == TABLE_IJF_DOUBLE_REPECHAGE)
            return _("IJF Qrt Final Rep");

        switch (sys.table) {
        case TABLE_DOUBLE_REPECHAGE: return (draw_system == DRAW_UKRAINIAN) ? _("UKR Dbl Repchg") : _("FIN Dbl Repchg");
        case TABLE_SWE_DUBBELT_AATERKVAL: return _("SWE Dubb terkv");
        case TABLE_SWE_DIREKT_AATERKVAL: return _("SWE Dir terkv");
        case TABLE_EST_D_KLASS: return _("EST D klass");
        case TABLE_NO_REPECHAGE: return _("No Repechg");
        case TABLE_SWE_ENKELT_AATERKVAL: return _("SWE Enkelt terkv");
        case TABLE_ESP_DOBLE_PERDIDA: return _("ESP Dbl Lost");
            /*case TABLE_ESP_REPESCA_DOBLE_INICIO: return _("ESP Dbl Rep/Bgn");*/
        case TABLE_ESP_REPESCA_DOBLE: return _("ESP Dbl Rep");
        case TABLE_ESP_REPESCA_SIMPLE: return _("ESP Simple Rep");
        case TABLE_MODIFIED_DOUBLE_ELIMINATION: return _("Modified Dbl Elim");
        case TABLE_DOUBLE_REPECHAGE_ONE_BRONZE: return _("FIN Dbl Repchg One Bronze");
        case TABLE_DOUBLE_LOST: return _("Double Lost");
        case TABLE_GBR_KNOCK_OUT: return _("GBR Knock Out");
        case TABLE_DEN_DOUBLE_ELIMINATION: return _("DEN Dbl Elim");
        case TABLE_EST_D_KLASS_ONE_BRONZE: return _("EST D klass 1 brz");
        }
    }

    return "";
}

// Return name of the system
static gchar *get_system_name(gint num)
{
    if (num == CAT_IJF_DOUBLE_REPECHAGE)
        return _("IJF Quarter Final Repechage");

    switch (num) {
    case CAT_SYSTEM_DEFAULT: return _("Default");
    case CAT_SYSTEM_POOL: return _("Pool");
    case CAT_SYSTEM_DPOOL: return _("Double Pool");
    case CAT_SYSTEM_QPOOL: return _("Quad Pool");
    case CAT_SYSTEM_DPOOL2: return _("Double Pool 2");
    case CAT_SYSTEM_DPOOL3: return _("Double Pool 3");
    case CAT_SYSTEM_REPECHAGE: return (draw_system == DRAW_UKRAINIAN) ? _("UKR Double Repechage") : _("FIN Double Repechage");
    case CAT_SYSTEM_DUBBELT_AATERKVAL: return _("SWE Double Repechage");
    case CAT_SYSTEM_DIREKT_AATERKVAL: return _("SWE Direct Repechage");
    case CAT_SYSTEM_EST_D_KLASS: return _("EST Double Elimination");
    case CAT_SYSTEM_NO_REPECHAGE: return _("Single Elimination");
    case CAT_SYSTEM_ENKELT_AATERKVAL: return _("SWE Single Repechage");
    case CAT_ESP_DOBLE_PERDIDA: return _("ESP Double Lost");
        /*case CAT_ESP_REPESCA_DOBLE_INICIO: return _("ESP Double Repechage from Beginning");*/
    case CAT_ESP_REPESCA_DOBLE: return _("ESP Double Repechage");
    case CAT_ESP_REPESCA_SIMPLE: return _("ESP Simple Repechage");
    case CAT_MODIFIED_DOUBLE_ELIMINATION: return _("Modified Double Elimination");
    case CAT_SYSTEM_REPECHAGE_ONE_BRONZE: return _("FIN Double Repechage One Bronze");
    case CAT_SYSTEM_DOUBLE_LOST: return _("Double Lost");
    case CAT_SYSTEM_GBR_KNOCK_OUT: return _("GBR Knock Out");
    case CAT_SYSTEM_BEST_OF_3: return _("Best of 3");
    case CAT_SYSTEM_DEN_DOUBLE_ELIMINATION: return _("DEN Double Elimination");
    case CAT_SYSTEM_EST_D_KLASS_ONE_BRONZE: return _("EST Double Elim One Bronze");
    case CAT_SYSTEM_CUSTOM: return _("Customized");
    }
    return "";
}

gchar *get_system_name_for_menu(gint num)
{
    return get_system_name(system_menu_order[num]);
}

gint get_system_number_by_menu_pos(gint num)
{
    return system_menu_order[num];
}

gint get_system_menu_selection(gint active)
{
    gint i;
    for (i = 0; i < NUM_SYSTEMS; i++)
	if (active == system_menu_order[i])
	    return i;

    return 0;
}

gboolean system_is_french(gint sys)
{
    switch (sys) {
    case SYSTEM_POOL:
    case SYSTEM_DPOOL:
    case SYSTEM_QPOOL:
    case SYSTEM_DPOOL2:
    case SYSTEM_DPOOL3:
    case SYSTEM_BEST_OF_3:
        return FALSE;
    }

    return TRUE;
}

gboolean system_wish_is_french(gint wish)
{
    switch (wish) {
    case CAT_SYSTEM_POOL:
    case CAT_SYSTEM_DPOOL:
    case CAT_SYSTEM_QPOOL:
    case CAT_SYSTEM_DPOOL2:
    case CAT_SYSTEM_DPOOL3:
    case CAT_SYSTEM_BEST_OF_3:
        return FALSE;
    }

    return TRUE;
}

gint is_special_match(struct compsys sys, gint match, gint *intval, double *doubleval, double *doubleval2)
{
    *intval = 0;
    *doubleval = *doubleval2 = 0.0;

    switch (sys.table) {
    case TABLE_DOUBLE_REPECHAGE:
    case TABLE_SWE_DUBBELT_AATERKVAL:
        switch (sys.system) {
        case  SYSTEM_FRENCH_32:
            switch (match) {
            case 41:
            case 42:
                *doubleval = 3.0;
                return SPECIAL_MORE_SPACE;
            case 1041:
            case 1042:
                *intval = F_BACK;
                return SPECIAL_MATCH_FLAG;
            }
            break;
        case  SYSTEM_FRENCH_128:
            switch (match) {
            case 141:
                *intval = 1;
                *doubleval = 0.50;
                *doubleval2 = 0.54;
                return SPECIAL_MATCH_X_Y;
            case 142:
                *intval = 1;
                *doubleval = 0.58;
                *doubleval2 = 0.62;
                return SPECIAL_MATCH_X_Y;
            }
        }
        break;
    case TABLE_SWE_DIREKT_AATERKVAL:
    case TABLE_NO_REPECHAGE:
    case TABLE_SWE_ENKELT_AATERKVAL:
        break;
    case TABLE_ESP_DOBLE_PERDIDA:
        switch (sys.system) {
        case  SYSTEM_FRENCH_8:
            switch (match) {
            case 7:
            case 8:
                return SPECIAL_MATCH_STOP;
            case 9:
            case 10:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 5:
            case 6:
                return SPECIAL_MATCH_START;
            case 11:
            case 12:
                return SPECIAL_MATCH_START;
            case 13:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_FLAG;
            }
        case  SYSTEM_FRENCH_16:
            switch (match) {
            case 21:
            case 22:
                return SPECIAL_MATCH_STOP;
            case 25:
            case 26:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 9:
            case 10:
            case 11:
            case 12:
                return SPECIAL_MATCH_START;
            case 27:
            case 28:
                return SPECIAL_MATCH_START;
            case 29:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_FLAG;
            }
        }
        break;
        /*case TABLE_ESP_REPESCA_DOBLE_INICIO:*/
    case TABLE_ESP_REPESCA_DOBLE: // IJF
        switch (sys.system) {
        case  SYSTEM_FRENCH_128:
            switch (match) {
            case 127:
                *intval = 1;
                *doubleval = 0.50;
                *doubleval2 = 0.54;
                return SPECIAL_MATCH_X_Y;
            case 128:
                *intval = 1;
                *doubleval = 0.58;
                *doubleval2 = 0.62;
                return SPECIAL_MATCH_X_Y;
            }
            break;
        }
        break;
    case TABLE_ESP_REPESCA_SIMPLE:
        break;
    case TABLE_MODIFIED_DOUBLE_ELIMINATION:
        switch (sys.system) {
        case  SYSTEM_FRENCH_32:
            switch (match) {
            case 61:
                *doubleval = 3.0;
                return SPECIAL_MORE_SPACE;
            }
            break;
        case  SYSTEM_FRENCH_64:
            switch (match) {
            case 117:
            case 118:
                *intval = 0;//F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 121:
                *intval = 1;
                *doubleval = 0.28;
                *doubleval2 = 0.32;
                return SPECIAL_MATCH_X_Y;
            case 122:
                *intval = 1;
                *doubleval = 0.36;
                *doubleval2 = 0.40;
                return SPECIAL_MATCH_X_Y;
            case 124:
                *intval = 1;
                *doubleval = 0.20;
                *doubleval2 = 0.24;
                return SPECIAL_MATCH_X_Y;
            }
        }
        break;
    case TABLE_DOUBLE_LOST:
        switch (sys.system) {
        case  SYSTEM_FRENCH_8:
            switch (match) {
            case 9:
            case 10:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 11:
            case 12:
                *doubleval = 1.5;
                return SPECIAL_UNCONNECTED_WHITE;
            }
            break;
        case  SYSTEM_FRENCH_16:
            switch (match) {
            case 25:
            case 26:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 27:
            case 28:
                *doubleval = 1.5;
                return SPECIAL_UNCONNECTED_WHITE;
            }
            break;
        case  SYSTEM_FRENCH_32:
            switch (match) {
            case 57:
            case 58:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 59:
            case 60:
                *doubleval = 2.0;
                return SPECIAL_UNCONNECTED_WHITE;
            }
            break;
        case  SYSTEM_FRENCH_64:
            switch (match) {
            case 113:
            case 115:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 117:
            case 118:
                //*intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 114:
            case 116:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 119:
            case 120:
                *doubleval = 2.0;
                *doubleval2 = 4.0;
                return SPECIAL_MATCH_START;
            case 123:
            case 124:
                *doubleval = 2.0;
                return SPECIAL_UNCONNECTED_WHITE;
            }
            break;
        }
        break;
    case TABLE_EST_D_KLASS:
    case TABLE_DEN_DOUBLE_ELIMINATION:
        switch (sys.system) {
        case SYSTEM_FRENCH_32:
            switch (match) {
            case 25:
                *doubleval = 0.02;
                return SPECIAL_MATCH_INC_Y;
            }
            break;
        }
        break;
    case TABLE_EST_D_KLASS_ONE_BRONZE:
        switch (sys.system) {
        case SYSTEM_FRENCH_32:
            switch (match) {
            case 25:
                *doubleval = 0.02;
                return SPECIAL_MATCH_INC_Y;
            }
            break;
        case SYSTEM_FRENCH_64:
            switch (match) {
            case 121:
            case 122:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 123:
                *intval = 2;
                *doubleval = 0.82;
                *doubleval2 = 0.86;
                return SPECIAL_MATCH_X_Y;
            }
            break;
        }
        break;
    case TABLE_GBR_KNOCK_OUT:
        switch (sys.system) {
        case  SYSTEM_FRENCH_32:
            switch (match) {
            case 25:
                *doubleval = 0.02;
                return SPECIAL_MATCH_INC_Y;
            case 49:
            case 50:
            case 51:
            case 52:
                *intval = F_REPECHAGE;
                return SPECIAL_MATCH_STOP;
            case 55:
                *intval = 5;
                *doubleval = 0.70;
                *doubleval2 = 0.74;
                return SPECIAL_MATCH_X_Y;
            case 56:
                *intval = 5;
                *doubleval = 0.78;
                *doubleval2 = 0.82;
                return SPECIAL_MATCH_X_Y;
            }
            break;
        }
        break;
    }

    return 0;
}

gboolean print_landscape(gint cat)
{
    return paint_pool_style_2(cat);
}

gboolean paint_pool_style_2(gint cat)
{
    struct compsys sys = get_cat_system(cat);

    if (sys.system == SYSTEM_POOL &&
        (sys.numcomp > 6 || pool_style))
        return TRUE;
    return FALSE;
}

gint next_page(gint cat, gint page)
{
    struct compsys sys = get_cat_system(cat);

    page++;
    if (page >= num_pages(sys))
        return 0;

    return page;
}

gint num_pages(struct compsys sys)
{
    gint pages = get_num_svg_pages(sys);

    if (pages)
        return pages;

    if (sys.system == SYSTEM_FRENCH_128)
        return 5;
    if (sys.table == TABLE_MODIFIED_DOUBLE_ELIMINATION &&
        sys.system == SYSTEM_FRENCH_64)
        return 4;
    if (sys.system == SYSTEM_FRENCH_64 ||
        sys.system == SYSTEM_QPOOL)
        return 3;
    if (sys.system == SYSTEM_DPOOL2)
        return 2;
    if (sys.system == SYSTEM_DPOOL && sys.numcomp > 10)
        return 2;
    if (sys.system == SYSTEM_DPOOL3 && sys.numcomp > 10)
        return 2;

    return 1;
}

gint db_position_to_real(struct compsys sys, gint pos)
{
    if (sys.system == SYSTEM_POOL || sys.system == SYSTEM_DPOOL2 ||
        sys.system == SYSTEM_DPOOL3 ||sys.system == SYSTEM_BEST_OF_3)
        return pos;

    if (pos == 1 || pos == 2 || pos == 3 || pos == 5 || pos == 7)
        return pos;

    if (pos == 4 || pos == 6 || pos == 8)
        return pos - 1;

    return pos;
}

static gint is_rep(gint t, gint s, gint f, gint m, gint level)
{
    gint r;

    if (++level > 20)
        return 0;

    if (f == 0 || m == 0)
        return 0;

    if (f == m)
        return level;

    gint f1 = french_matches[t][s][f][0];
    gint f2 = french_matches[t][s][f][1];

    if (f1 > 0 && (r = is_rep(t, s, f1, m, level)))
        return r;

    if (f2 > 0 && (r = is_rep(t, s, f2, m, level)))
        return r;

    return 0;
}

gint is_repechage(struct compsys systm, gint m)
{
    gint r;

    if (systm.system == SYSTEM_CUSTOM) {
        return 0;
    }

    if (!system_is_french(systm.system))
        return 0;

    gint sys = systm.system - SYSTEM_FRENCH_8;

    gint b1 = medal_matches[systm.table][sys][0];
    gint b2 = medal_matches[systm.table][sys][1];

    if (m == b1 || m == b2)
        return 0;

    if (systm.table == TABLE_DOUBLE_LOST) {
        int match1 = french_matches[systm.table][sys][b1][0];
        int match2 = french_matches[systm.table][sys][b1][1];
        if (match1 < match2) {
            b1 = match2;
            b2 = french_matches[systm.table][sys][b2][1];
        } else {
            b1 = match1;
            b2 = french_matches[systm.table][sys][b2][0];
        }
    }

    if ((r = is_rep(systm.table, sys, b1, m, 0)))
	return r | ROUND_UPPER;
    if ((r = is_rep(systm.table, sys, b2, m, 0)))
	return r | ROUND_LOWER;
    return 0;
}

const gint french_rounds[NUM_TABLES][NUM_FRENCH][NUM_MATCHES] = {
    { /* Table 0 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1261,0x1261,0x2261,
            0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x225f,
            0x225f,0x1260,0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 4 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,
            0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x2003,0x2003,0x2003,
            0x2003,0x1004,0x1004,0x1004,0x1004,0x2004,0x2004,0x2004,0x2004,0x1005,0x1005,0x2005,0x2005,0x125e,0x125e,0x225e,
            0x225e,0x125f,0x125f,0x225f,0x225f,0x1260,0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,
            0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 1 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1261,0x1261,0x2261,
            0x2261,0x1262,0x2262,0x1300,0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1300,0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x225f,
            0x225f,0x1260,0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1300,0x2300,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 2 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1260,0x1260,0x2260,0x2260,0x1002,0x1002,0x2002,
            0x2002,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,0x225e,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,
            0x2002,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1003,0x1003,0x2003,0x2003,0x1260,0x1260,0x2260,
            0x2260,0x1300,0x2300,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,
            0x225c,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,
            0x225d,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,
            0x225e,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1300,0x2300,0x1260,
            0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 3 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,
            0x225e,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1003,0x1003,0x2003,0x2003,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,
            0x225c,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,
            0x225d,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,
            0x225e,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1004,0x1004,0x2004,0x2004,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 4 */
        { /* sys 0 */
            0x0000,0x1262,0x1262,0x2262,0x2262,0x1300,0x2300,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1261,0x1261,0x1261,0x1261,0x2261,0x2261,0x2261,0x2261,0x1262,0x1262,0x2262,0x2262,0x1300,0x2300,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x2260,0x2260,0x2260,0x2260,0x2260,0x2260,0x2260,
            0x2260,0x1261,0x1261,0x1261,0x1261,0x2261,0x2261,0x2261,0x2261,0x1262,0x1262,0x2262,0x2262,0x1300,0x2300,0x0600,
        },
        { /* sys 3 */
            0x0000,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,0x125f,
            0x125f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,0x225f,
            0x225f,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x1260,0x2260,0x2260,0x2260,0x2260,0x2260,0x2260,0x2260,
            0x2260,0x1261,0x1261,0x1261,0x1261,0x2261,0x2261,0x2261,0x2261,0x1262,0x1262,0x2262,0x2262,0x1300,0x2300,0x0600,
        },
    },
    { /* Table 5 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1300,0x2300,0x1262,
            0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1300,0x2300,0x1261,
            0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x1300,0x2300,0x1260,
            0x2260,0x1261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 6 */
        { /* sys 0 */
            0x0000,0x1261,0x1261,0x2261,0x2261,0x2261,0x1261,0x1262,0x2262,0x2262,0x1262,0x1300,0x2300,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1260,0x1260,0x1260,0x1260,0x2260,0x2260,0x2260,0x2260,0x225f,0x225f,0x125f,0x125f,0x1261,0x1261,0x2261,
            0x2261,0x2260,0x2260,0x1260,0x1260,0x1262,0x2262,0x2261,0x1261,0x2262,0x1262,0x1300,0x2300,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x225f,
            0x225f,0x1260,0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 7 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1262,0x2262,0x1300,0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1262,0x2262,0x1300,
            0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1262,0x2262,0x1300,
            0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x1262,0x2262,0x1300,
            0x2300,0x1400,0x2400,0x0600,
        },
        { /* sys 4 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,
            0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x2003,0x2003,0x2003,
            0x2003,0x1004,0x1004,0x1004,0x1004,0x2004,0x2004,0x2004,0x2004,0x1005,0x1005,0x2005,0x2005,0x1262,0x2262,0x1300,
            0x2300,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 8 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1300,0x2300,0x1262,
            0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1300,0x2300,0x1262,
            0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x1300,0x2300,0x1262,
            0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 9 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x2260,0x2260,0x1300,0x2300,0x2261,0x2261,0x2262,0x0600,0x0500,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x225e,0x225e,0x225e,0x225e,0x1002,0x1002,0x2002,
            0x2002,0x225f,0x225f,0x225f,0x225f,0x2260,0x2260,0x1300,0x2300,0x2261,0x2261,0x2262,0x0600,0x0500,
        },
        { /* sys 2 */
            0x0000,
	    0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001, // round 1
	    0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
	    0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c, // rep 1
	    0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002, // round 2
            0x125d,0x125d,0x125d,0x125d,0x225d,0x225d,0x225d,0x225d, // rep 2
	    0x125e,0x125e,0x225e,0x225e, // rep 3
	    0x1003,0x1003,0x2003,0x2003, // round 3
            0x125f,0x125f,0x225f,0x225f, // rep 4
	    0x1300,0x2300, // sem
	    0x1260,0x2260,0x1261,0x2261,0x1262,0x0600,0x0500,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,0x225a,
            0x225a,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,0x225b,
            0x225b,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,
            0x2003,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225e,0x225e,0x225e,0x225e,0x1004,0x1004,0x2004,
            0x2004,0x225f,0x225f,0x225f,0x225f,0x2260,0x2260,0x1300,0x2300,0x2261,0x2261,0x2262,0x0600,0x0500,
        },
    },
    { /* Table 10 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1260,0x1260,0x1260,
            0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x125f,0x125f,0x125f,
            0x125f,0x1260,0x1260,0x1260,0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x125e,0x125e,0x125e,
            0x125e,0x125f,0x125f,0x125f,0x125f,0x1260,0x1260,0x1260,0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,
            0x0600,
        },
    },
    { /* Table 11 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1002,0x2002,0x1262,0x2262,0x1263,0x2263,0x1300,0x2300,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1003,0x2003,0x1260,
            0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1263,0x2263,0x1300,0x2300,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1004,0x2004,0x225e,
            0x225e,0x225e,0x225e,0x125e,0x125e,0x125e,0x125e,0x225f,0x225f,0x225f,0x225f,0x125f,0x125f,0x125f,0x125f,0x2260,
            0x2260,0x1260,0x1260,0x2261,0x2261,0x1261,0x1261,0x2262,0x1262,0x2263,0x1263,0x2300,0x1300,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,
            0x225c,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,
            0x125d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,
            0x225e,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1005,0x2005,0x1262,0x2262,0x1263,0x2263,0x1300,0x2300,0x0600,
        },
    },
    { /* Table 12 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x125e,0x125e,0x225e,0x225e,0x225e,0x225e,0x125e,
            0x125e,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x125f,0x125f,0x1003,0x1003,0x2003,0x2003,0x1260,0x2260,0x2260,
            0x1260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,
            0x225c,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,
            0x225d,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x125e,0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,
            0x225e,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1004,0x1004,0x2004,0x2004,0x1260,0x1260,0x2260,
            0x2260,0x1261,0x1261,0x2261,0x2261,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 13 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x1300,0x2300,0x1260,
            0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x1003,0x1003,0x2003,0x2003,0x1300,0x2300,0x125e,
            0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,0x225e,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1260,
            0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x1004,0x1004,0x2004,0x2004,0x1300,0x2300,0x125c,
            0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x225c,0x125d,
            0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x225d,0x125e,
            0x125e,0x125e,0x125e,0x225e,0x225e,0x225e,0x225e,0x125f,0x125f,0x125f,0x125f,0x225f,0x225f,0x225f,0x225f,0x1260,
            0x1260,0x2260,0x2260,0x1261,0x1261,0x2261,0x2261,0x1262,0x2262,0x1400,0x2400,0x0600,
        },
    },
    { /* Table 14 */
        { /* sys 0 */
            0x0000,0x1001,0x1001,0x2001,0x2001,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 1 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x1002,0x1002,0x2002,0x2002,0x125f,0x125f,0x125f,
            0x125f,0x1260,0x1260,0x1260,0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 2 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,
            0x125d,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x1003,0x1003,0x2003,0x2003,0x125f,0x125f,0x125f,
            0x125f,0x1260,0x1260,0x1260,0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
        { /* sys 3 */
            0x0000,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,0x1001,
            0x1001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,0x2001,
            0x2001,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x1002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,0x2002,
            0x2002,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,0x125b,
            0x125b,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,0x125c,
            0x125c,0x1003,0x1003,0x1003,0x1003,0x2003,0x2003,0x2003,0x2003,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,0x125d,
            0x125d,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x125e,0x1004,0x1004,0x2004,0x2004,0x125f,0x125f,0x125f,
            0x125f,0x1260,0x1260,0x1260,0x1260,0x1300,0x2300,0x1261,0x1261,0x1262,0x1262,0x1400,0x0600,
        },
    },
};

static gint is_on_path(gint t, gint s, gint f, gint m, gint level)
{
    gint r;

    if (++level > 20)
        return 0;

    if (f == 0 || m == 0)
        return 0;

    if (f == m)
        return level;

    gint f1 = french_matches[t][s][f][0];
    gint f2 = french_matches[t][s][f][1];

    if (f1 > 0 && (r = is_on_path(t, s, f1, m, level)))
        return r;

    if (f2 > 0 && (r = is_on_path(t, s, f2, m, level)))
        return r;

    return 0;
}

gint round_number(struct category_data *cd, gint m)
{
    gint matchnum;
    struct compsys systm = cd->system;

    if (m == 0 ||
	systm.system == 0 ||
	systm.system == SYSTEM_CUSTOM ||
	systm.numcomp == 0) {
        return 0;
    }

    if (!system_is_french(systm.system)) {
	switch (systm.system) {
	case SYSTEM_POOL:
	case SYSTEM_DPOOL2:
	case SYSTEM_QPOOL:
	case SYSTEM_BEST_OF_3:
	    return ROUND_ROBIN + m;

	case SYSTEM_DPOOL:
	    matchnum = num_matches(systm.system, systm.numcomp) + 3;
	    if (m > matchnum)
		return 0;
	    if (m == matchnum - 2)
		return ROUND_SEMIFINAL_1;
	    else if (m == matchnum - 1)
		return ROUND_SEMIFINAL_2;
	    else if (m == matchnum)
		return ROUND_FINAL;
	    return ROUND_ROBIN + m;

	case SYSTEM_DPOOL3:
	    matchnum = num_matches(systm.system, systm.numcomp) + 2;
	    if (m == matchnum - 1)
		return ROUND_BRONZE;
	    else if (m == matchnum)
		return ROUND_FINAL;
	    return ROUND_ROBIN + m;
	}

        return ROUND_ROBIN;
    }

    gint sys = systm.system - SYSTEM_FRENCH_8;

#ifndef CALCULATE_ROUNDS
    /* Use table. */
    return french_rounds[systm.table][sys][m];
#else
    /* Calculate. */
    gint r = 1, i, rep;

    /* Find the last match. */
    for (i = NUM_MATCHES-1; i >= 0; i--)
	if (french_matches[systm.table][sys][i][0] ||
	    french_matches[systm.table][sys][i][1])
	    break;
    if (m > i)
	return 0x7771;

    if ((rep = is_repechage(systm, m)))
	return (ROUND_REPECHAGE + 100 - (rep & ROUND_MASK)) |
	    (rep & ROUND_UP_DOWN_MASK);

    if (systm.table == TABLE_MODIFIED_DOUBLE_ELIMINATION) {
	if (m == medal_matches[systm.table][sys][1])
	    return ROUND_SILVER;
	if (m == medal_matches[systm.table][sys][2])
	    return ROUND_FINAL;
    }
    if (m == french_matches[systm.table][sys][medal_matches[systm.table][sys][2]][0])
	return ROUND_SEMIFINAL_1;
    if (m == french_matches[systm.table][sys][medal_matches[systm.table][sys][2]][1])
	return ROUND_SEMIFINAL_2;
    if (m == medal_matches[systm.table][sys][0])
	return ROUND_BRONZE_1;
    if (m == medal_matches[systm.table][sys][1])
	return ROUND_BRONZE_2;
    if (m == medal_matches[systm.table][sys][2])
	return ROUND_FINAL;

    gint upper = is_on_path(systm.table, sys,
			    french_matches[systm.table][sys][medal_matches[systm.table][sys][2]][0],
			    m, 0);

    while ((m = french_matches[systm.table][sys][m][0]) > 0)
	r++;

    if (m == 0) {
	return r | (upper ? ROUND_UPPER : ROUND_LOWER);
    }
    return -1;
#endif
}

const gchar *round_name(struct category_data *cd, gint m)
{
    gint n = round_number(cd, m);
    return round_to_str(n);
}

#ifdef CALCULATE_ROUNDS
/* Generate round number table. */
void print_rounds(void)
{
    gint tbl, sys, m, i;
    struct compsys systm;

    systm.numcomp = 1; /* non-zero */

    g_print("const gint french_rounds[NUM_TABLES][NUM_FRENCH][NUM_MATCHES] = {\n");

    for (tbl = 0; tbl < NUM_TABLES; tbl++) {
	systm.table = tbl;
	g_print("    { /* Table %d */\n", tbl);
	for (sys = 0; sys < NUM_FRENCH; sys++) {
	    /* Find the last match. */
	    for (i = NUM_MATCHES-1; i >= 0; i--)
		if (french_matches[systm.table][sys][i][0] ||
		    french_matches[systm.table][sys][i][1])
		    break;
	    if (i <= 0)
		continue;

	    systm.system = SYSTEM_FRENCH_8 + sys;
	    g_print("        { /* sys %d */", sys);
	    for (m = 0; m <= i; m++) {
		gint r = round_number(systm, m);
		if ((m & 15) == 0) g_print("\n            ");
		g_print("0x%04x,", r);
	    }
	    g_print("\n        },\n");
	}
	g_print("    },\n");
    }

    g_print("};\n");
}
#endif

gint num_matches_left(gint index, gint competitors)
{
    struct category_data *cat = avl_get_category(index);
    struct compsys systm = get_system_for_category(index, competitors);

    if (cat && (cat->match_status & REAL_MATCH_EXISTS)) {
        if ((cat->match_status & MATCH_UNMATCHED) == 0)
            return 0;

        if (cat->match_count > 0)
            return cat->match_count - cat->matched_matches_count;
    }

    if (systm.system == SYSTEM_CUSTOM) {
        struct custom_data *cd = get_custom_table(systm.table);
        if (cd) return cd->num_matches;
        return 20; // error
    }

    if (system_is_french(systm.system)) {
        gint sys = systm.system - SYSTEM_FRENCH_8;
        gint high = 8 << sys; // max number of competitors in this system
        gint table = systm.table;
        gint comp = systm.numcomp;
        gint upper = french_num_matches[table][sys];
        gint lower = (sys == 0) ? 0 : french_num_matches[table][sys-1];

        return upper - (high - comp)*(upper - lower)*2/high;
    }

    gint n = num_matches(systm.system, systm.numcomp);
    switch (systm.system) {
    case SYSTEM_POOL:  return n;
    case SYSTEM_DPOOL: return n + 3;
    case SYSTEM_QPOOL: return n + 7;
    case SYSTEM_DPOOL2: return n + 6;
    case SYSTEM_DPOOL3: return n + 2;
    case SYSTEM_BEST_OF_3: return n;
    }

    return n;
}

gint num_matches_estimate(gint index)
{
    struct category_data *catdata = avl_get_category(index);
    gint mul = 1;

    if (!catdata)
        return 5;

    struct compsys systm = catdata->system;

    if (catdata->deleted & TEAM_EVENT) {
        mul = find_num_weight_classes(catdata->category);
        if (mul == 0) mul = 1;
    }

    if (systm.system == SYSTEM_CUSTOM) {
        struct custom_data *cd = get_custom_table(systm.table);
        if (cd && cd->num_matches) return mul*cd->num_matches;
        g_print("ERROR: Custom category %s returned num_matches=0 cd=%p matches=%d\n",
                catdata->category, cd, cd ? cd->num_matches : 0);
        assert(cd);
        assert(cd->num_matches > 0);
        return mul*20; // error
    }

    if (system_is_french(systm.system)) {
        return mul*french_num_matches[systm.table][systm.system - SYSTEM_FRENCH_8];
    }

    gint n = num_matches(systm.system, systm.numcomp);
    switch (systm.system) {
    case SYSTEM_POOL:  return mul*n;
    case SYSTEM_DPOOL: return mul*(n + 3);
    case SYSTEM_QPOOL: return mul*(n + 7);
    case SYSTEM_DPOOL2: return mul*(n + 6);
    case SYSTEM_DPOOL3: return mul*(n + 2);
    case SYSTEM_BEST_OF_3: return mul*3;
    }

    return mul;
}
const gchar *get_points_str(gint points)
{
    if (prop_get_int_val(PROP_RULES_2017)) {
	switch (points) {
	case 10: return "10";
	case 7: return "1";
	case 5: return "1"; // same as waza-ari
	case 1: return "0";
	}
    } else if (prop_get_int_val(PROP_USE_IJF_POINTS)) {
	switch (points) {
	case 10: return "100";
	case 7: return "10";
	case 5: return "1";
	case 1: return "";
	}
    } else {
	switch (points) {
	case 10: return "10";
	case 7: return "7";
	case 5: return "5";
	case 1: return "1";
	}
    }
    return "0";
}

/* Convert points to an integer. Return double value to handle half point. */
gint get_points_gint(gint points)
{
    if (prop_get_int_val(PROP_RULES_2017)) {
	switch (points) {
	case 10: return 20;
	case 7: return 2;
	case 5: return 2;
	case 1: return 0;
	}
    } else if (prop_get_int_val(PROP_USE_IJF_POINTS)) {
	switch (points) {
	case 10: return 200;
	case 7: return 20;
	case 5: return 2;
	case 1: return 1;
	}
    } else {
	switch (points) {
	case 10: return 20;
	case 7: return 14;
	case 5: return 10;
	case 1: return 2;
	}
    }
    return 0;
}

gchar *get_score_str(gint score)
{
    static gchar buf[2][16];
    static gint i = 0;
    i ^= 1;
    gchar *p = buf[i];
    gint a = (score >> 16) & 0x1;
    *p++ = '0' + a;
    a = (score >> 12) & 0x3;
    *p++ = '0' + a;
    if (!prop_get_int_val(PROP_RULES_2017)) {
	a = (score >> 8) & 0xf;
	if (a > 9) a = 9;
	*p++ = '0' + a;
    }
    if (score & 0x7) {
	*p++ = 's';
	*p++ = '0' + (score & 0x7);
    }
    if (score & 0x8)
	*p++ = 'H';
    *p = 0;

    return buf[i];
}

gint match_on_page(gint category, gint match)
{
    struct category_data *catdata = avl_get_category(category);
    if (!catdata)
        return 0;

    struct compsys systm = catdata->system;
    gint table = systm.table;

    if (systm.system == SYSTEM_CUSTOM)
	return 0;

    if (system_is_french(systm.system)) {
	switch (systm.system) {
	case SYSTEM_FRENCH_8:
	case SYSTEM_FRENCH_16:
	case SYSTEM_FRENCH_32:
	    return 0;
	case SYSTEM_FRENCH_64:
	    if (match <= 16) return 0;
	    if (match <= 32) return 1;
	    return french_64_matches_to_page[table][match];
	case SYSTEM_FRENCH_128:
	    if (match <= 16) return 0;
	    if (match <= 32) return 1;
	    if (match <= 48) return 2;
	    if (match <= 64) return 3;
	    return french_128_matches_to_page[table][match];
	}
	return 0;
    }

    gint n = num_matches(systm.system, systm.numcomp);
    gint s;
    switch (systm.system) {
    case SYSTEM_POOL:  return 0;
    case SYSTEM_DPOOL:
	if (systm.numcomp <= 10) return 0;
	if (match <= n - 3) return 0;
	return 1;
    case SYSTEM_QPOOL:
	if (match > n - 7) return 2;
	s = (match-1) % 4;
	if (s <= 1) return 0;
	return 1;
    case SYSTEM_DPOOL2:
	if (match <= n - 6) return 0;
	return 1;
    case SYSTEM_DPOOL3:
	if (match <= n - 2) return 0;
	return 1;
    case SYSTEM_BEST_OF_3: return 0;
    }
    return 0;
}
